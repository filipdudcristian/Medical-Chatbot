{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Doodles\\\\Desktop\\\\react-auth-main\\\\src\\\\components\\\\ChatApp.js\",\n  _s = $RefreshSig$();\nimport { useState } from \"react\";\nimport { Button } from \"react-bootstrap\";\nimport \"./ChatApp.css\";\nimport \"@chatscope/chat-ui-kit-styles/dist/default/styles.min.css\";\nimport { useUserAuth } from \"../context/UserAuthContext\";\nimport { Link, useNavigate } from \"react-router-dom\";\nimport { MainContainer, ChatContainer, MessageList, Message, MessageInput, TypingIndicator } from \"@chatscope/chat-ui-kit-react\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst ChatApp = () => {\n  _s();\n  // State to manage the typing indicator of the chatbot\n  const [isChatbotTyping, setIsChatbotTyping] = useState(false);\n  const {\n    logOut,\n    user\n  } = useUserAuth();\n  const navigate = useNavigate();\n  const handleLogout = async () => {\n    try {\n      await logOut();\n      navigate(\"/\");\n    } catch (error) {\n      console.log(error.message);\n    }\n  };\n\n  // State to store chat messages\n  const [chatMessages, setChatMessages] = useState([{\n    message: \"Buna, sunt Doctorul Virtual si sunt aici pentru a va raspunde la intrebarile tale medicale\",\n    sender: \"Doctorul Virtual\"\n  }]);\n\n  // Function to handle user messages\n  const handleUserMessage = async userMessage => {\n    // Create a new user message object\n    const newUserMessage = {\n      message: userMessage,\n      sender: \"user\",\n      direction: \"outgoing\"\n    };\n\n    // Update chat messages state with the new user message\n    const updatedChatMessages = [...chatMessages, newUserMessage];\n    setChatMessages(updatedChatMessages);\n\n    // Set the typing indicator for the chatbot\n    setIsChatbotTyping(true);\n\n    // Process user message with ChatGPT\n    await processUserMessageToChatGPT(updatedChatMessages);\n  };\n\n  // Function to send the user message to ChatGPT API\n  async function processUserMessageToChatGPT(messages) {\n    //console.log(messages)\n    // Prepare the messages in the required format for the API\n    let apiMessages = messages.map(messageObject => {\n      let role = \"\";\n      if (messageObject.sender === \"Doctorul Virtual\") {\n        role = \"assistant\";\n      } else {\n        role = \"user\";\n      }\n      return {\n        role: role,\n        content: messageObject.message\n      };\n    });\n    console.log(messages.at(messages.length - 1).message);\n    // System message for ChatGPT\n    const systemMessage = {\n      role: \"system\",\n      content: \"Explain all concept like a Professor in Biochemistry\"\n    };\n\n    // Prepare the API request body\n    //  const apiRequestBody = {\n    //    model: \"gpt-3.5-turbo\",\n    //    messages: [\n    //      systemMessage, // System message should be in front of user messages\n    //      ...apiMessages,\n    //    ],\n    //  };\n\n    let prompt = messages.at(messages.length - 1).message;\n    const apiRequestBody = {\n      prompt\n    };\n\n    // Send the user message to ChatGPT API\n    await fetch(\"http://localhost:8080/chat\", {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\"\n      },\n      body: JSON.stringify(apiRequestBody)\n    }).then(data => {\n      //console.log(data.json());\n      return data.json();\n    }).then(data => {\n      // Update chat messages with ChatGPT's response\n      console.log(data);\n      setChatMessages([...messages, {\n        //message: data.choices[0].message.content,\n        message: data.message,\n        sender: \"Doctorul Virtual\"\n      }]);\n      // Set the typing indicator to false after getting the response\n      setIsChatbotTyping(false);\n    });\n  }\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        position: \"relative\",\n        height: \"1000px\",\n        width: \"700px\"\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"p-4 box mt-3 text-center\",\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          children: [\"Bine ai venit, \", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 128,\n            columnNumber: 30\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 128,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"h4\", {\n          children: user\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 129,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 127,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"d-grid gap-2\",\n        children: /*#__PURE__*/_jsxDEV(Button, {\n          className: \"text-center\",\n          variant: \"primary\",\n          onClick: handleLogout,\n          children: \"Log out\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 133,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 132,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(MainContainer, {\n        children: /*#__PURE__*/_jsxDEV(ChatContainer, {\n          children: [/*#__PURE__*/_jsxDEV(MessageList, {\n            typingIndicator: isChatbotTyping ? /*#__PURE__*/_jsxDEV(TypingIndicator, {\n              content: \"Doctorul Virtual tasteaza...\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 145,\n              columnNumber: 18\n            }, this) : null,\n            children: chatMessages.map((message, i) => {\n              return /*#__PURE__*/_jsxDEV(Message, {\n                model: message,\n                style: message.sender === \"Doctorul Virtual\" ? {\n                  textAlign: \"left\"\n                } : {}\n              }, i, false, {\n                fileName: _jsxFileName,\n                lineNumber: 152,\n                columnNumber: 18\n              }, this);\n            })\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 142,\n            columnNumber: 12\n          }, this), /*#__PURE__*/_jsxDEV(MessageInput, {\n            placeholder: \"Scrie mesajul aici\",\n            onSend: handleUserMessage,\n            onAttachClick: handleUserMessage\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 163,\n            columnNumber: 12\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 140,\n          columnNumber: 10\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 139,\n        columnNumber: 8\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 126,\n      columnNumber: 6\n    }, this)\n  }, void 0, false);\n};\n_s(ChatApp, \"OTqnqZ+Yswb6mpWxHGuLRil0X8o=\", false, function () {\n  return [useUserAuth, useNavigate];\n});\n_c = ChatApp;\nexport default ChatApp;\nvar _c;\n$RefreshReg$(_c, \"ChatApp\");","map":{"version":3,"names":["useState","Button","useUserAuth","Link","useNavigate","MainContainer","ChatContainer","MessageList","Message","MessageInput","TypingIndicator","jsxDEV","_jsxDEV","Fragment","_Fragment","ChatApp","_s","isChatbotTyping","setIsChatbotTyping","logOut","user","navigate","handleLogout","error","console","log","message","chatMessages","setChatMessages","sender","handleUserMessage","userMessage","newUserMessage","direction","updatedChatMessages","processUserMessageToChatGPT","messages","apiMessages","map","messageObject","role","content","at","length","systemMessage","prompt","apiRequestBody","fetch","method","headers","body","JSON","stringify","then","data","json","children","style","position","height","width","className","fileName","_jsxFileName","lineNumber","columnNumber","variant","onClick","typingIndicator","i","model","textAlign","placeholder","onSend","onAttachClick","_c","$RefreshReg$"],"sources":["C:/Users/Doodles/Desktop/react-auth-main/src/components/ChatApp.js"],"sourcesContent":["import { useState } from \"react\";\r\nimport { Button } from \"react-bootstrap\";\r\nimport \"./ChatApp.css\";\r\nimport \"@chatscope/chat-ui-kit-styles/dist/default/styles.min.css\";\r\nimport { useUserAuth } from \"../context/UserAuthContext\";\r\nimport { Link, useNavigate } from \"react-router-dom\";\r\nimport {\r\n MainContainer,\r\n ChatContainer,\r\n MessageList,\r\n Message,\r\n MessageInput,\r\n TypingIndicator,\r\n} from \"@chatscope/chat-ui-kit-react\";\r\n\r\nconst ChatApp = () => {\r\n // State to manage the typing indicator of the chatbot\r\n const [isChatbotTyping, setIsChatbotTyping] = useState(false);\r\n const { logOut, user } = useUserAuth();\r\n const navigate = useNavigate();\r\n const handleLogout = async () => {\r\n    try {\r\n      await logOut();\r\n      navigate(\"/\");\r\n    } catch (error) {\r\n      console.log(error.message);\r\n    }\r\n  };\r\n\r\n // State to store chat messages\r\n const [chatMessages, setChatMessages] = useState([\r\n   {\r\n     message: \"Buna, sunt Doctorul Virtual si sunt aici pentru a va raspunde la intrebarile tale medicale\",\r\n     sender: \"Doctorul Virtual\",\r\n   },\r\n ]);\r\n\r\n // Function to handle user messages\r\n const handleUserMessage = async (userMessage) => {\r\n   // Create a new user message object\r\n   const newUserMessage = {\r\n     message: userMessage,\r\n     sender: \"user\",\r\n     direction: \"outgoing\",\r\n   };\r\n\r\n   // Update chat messages state with the new user message\r\n   const updatedChatMessages = [...chatMessages, newUserMessage];\r\n   setChatMessages(updatedChatMessages);\r\n\r\n   // Set the typing indicator for the chatbot\r\n   setIsChatbotTyping(true);\r\n\r\n   // Process user message with ChatGPT\r\n   await processUserMessageToChatGPT(updatedChatMessages);\r\n };\r\n\r\n // Function to send the user message to ChatGPT API\r\n async function processUserMessageToChatGPT(messages) {\r\n  //console.log(messages)\r\n   // Prepare the messages in the required format for the API\r\n   let apiMessages = messages.map((messageObject) => {\r\n     let role = \"\";\r\n     if (messageObject.sender === \"Doctorul Virtual\") {\r\n       role = \"assistant\";\r\n     } else {\r\n       role = \"user\";\r\n     }\r\n     return { role: role, content: messageObject.message };\r\n   });\r\n\r\n   console.log(messages.at(messages.length - 1).message)\r\n   // System message for ChatGPT\r\n   const systemMessage = {\r\n     role: \"system\",\r\n     content: \"Explain all concept like a Professor in Biochemistry\",\r\n   };\r\n\r\n   // Prepare the API request body\r\n  //  const apiRequestBody = {\r\n  //    model: \"gpt-3.5-turbo\",\r\n  //    messages: [\r\n  //      systemMessage, // System message should be in front of user messages\r\n  //      ...apiMessages,\r\n  //    ],\r\n  //  };\r\n\r\n  let prompt = messages.at(messages.length - 1).message\r\n\r\n  const apiRequestBody = {\r\n    prompt\r\n  }\r\n\r\n   // Send the user message to ChatGPT API\r\n   await fetch(\"http://localhost:8080/chat\", {\r\n     method: \"POST\",\r\n     headers: {\r\n       \"Content-Type\": \"application/json\"\r\n     },\r\n     body: JSON.stringify(apiRequestBody),\r\n   })\r\n     .then((data) => {\r\n       //console.log(data.json());\r\n       return data.json();\r\n     })\r\n     .then((data) => {\r\n       // Update chat messages with ChatGPT's response\r\n       console.log(data);\r\n       setChatMessages([\r\n         ...messages,\r\n         {\r\n           //message: data.choices[0].message.content,\r\n           message: data.message,\r\n           sender: \"Doctorul Virtual\",\r\n         },\r\n       ]);\r\n       // Set the typing indicator to false after getting the response\r\n       setIsChatbotTyping(false);\r\n     });\r\n }\r\n\r\n return (\r\n   <>\r\n    \r\n     {/* A container for the chat window */}\r\n     <div style={{ position: \"relative\", height: \"1000px\", width: \"700px\" }}>\r\n        <div className=\"p-4 box mt-3 text-center\">\r\n          <h3>Bine ai venit, <br /></h3>\r\n          <h4>{user}</h4>\r\n        </div>\r\n        \r\n        <div className=\"d-grid gap-2\">\r\n            <Button className=\"text-center\" variant=\"primary\"  onClick={handleLogout}>\r\n              Log out\r\n            </Button>\r\n            \r\n\r\n        </div>\r\n       <MainContainer>\r\n         <ChatContainer>\r\n           {/* Display chat messages and typing indicator */}\r\n           <MessageList\r\n             typingIndicator={\r\n               isChatbotTyping ? (\r\n                 <TypingIndicator content=\"Doctorul Virtual tasteaza...\" />\r\n               ) : null\r\n             }\r\n           >\r\n             {/* Map through chat messages and render each message */}\r\n             {chatMessages.map((message, i) => {\r\n               return (\r\n                 <Message\r\n                   key={i}\r\n                   model={message}\r\n                   style={\r\n                     message.sender === \"Doctorul Virtual\" ? { textAlign: \"left\" } : {}\r\n                   }\r\n                 />\r\n               );\r\n             })}\r\n           </MessageList>\r\n           {/* Input field for the user to type messages */}\r\n           <MessageInput\r\n             placeholder=\"Scrie mesajul aici\"\r\n             onSend={handleUserMessage}\r\n             onAttachClick={handleUserMessage}\r\n           />\r\n         </ChatContainer>\r\n       </MainContainer>\r\n     </div>\r\n   </>\r\n );\r\n}\r\n\r\nexport default ChatApp;"],"mappings":"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"},"metadata":{},"sourceType":"module"}